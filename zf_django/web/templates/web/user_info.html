{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‚¬ìš©ì ì •ë³´ ì…ë ¥</title>
    <script src="{% static 'js/main.js' %}"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 500px;
            width: 100%;
            padding: 40px;
        }

        h1 {
            color: #065f46;
            margin-bottom: 10px;
            font-size: 28px;
            text-align: center;
        }

        .subtitle {
            color: #047857;
            text-align: center;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #064e3b;
            font-weight: 600;
            font-size: 14px;
        }

        .required {
            color: #dc2626;
            margin-left: 2px;
        }

        input[type="text"],
        input[type="number"],
        select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #d1fae5;
            border-radius: 10px;
            font-size: 15px;
            transition: all 0.3s ease;
            background: #f0fdf4;
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        select:focus {
            outline: none;
            border-color: #10b981;
            background: white;
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
        }

        input[type="text"]:read-only {
            background: #ecfdf5;
            cursor: not-allowed;
            border-color: #a7f3d0;
        }

        .radio-group {
            display: flex;
            gap: 15px;
            margin-top: 8px;
        }

        .radio-option {
            flex: 1;
        }

        .radio-option input[type="radio"] {
            display: none;
        }

        .radio-option label {
            display: block;
            padding: 12px;
            border: 2px solid #d1fae5;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f0fdf4;
            font-weight: 500;
            margin-bottom: 0;
            color: #065f46;
        }

        .radio-option input[type="radio"]:checked + label {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border-color: #10b981;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .radio-option label:hover {
            border-color: #10b981;
            transform: translateY(-2px);
            background: #ecfdf5;
        }

        .radio-option input[type="radio"]:checked + label:hover {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
        }

        select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23065f46' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 15px center;
            padding-right: 40px;
            color: #065f46;
        }

        .input-hint {
            font-size: 12px;
            color: #059669;
            margin-top: 5px;
        }

        .btn-submit {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.2);
        }

        .btn-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(16, 185, 129, 0.4);
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
        }

        .btn-submit:active {
            transform: translateY(0);
        }

        @media (max-width: 480px) {
            .container {
                padding: 30px 20px;
            }

            h1 {
                font-size: 24px;
            }

            .radio-group {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ‘¤ ì‚¬ìš©ì ì •ë³´</h1>
        <p class="subtitle">ì •í™•í•œ ì£¼íƒ ì •ë³´ ì œê³µì„ ìœ„í•´ í•„ìš”í•œ ì •ë³´ì…ë‹ˆë‹¤</p>
        
        <form id="userInfoForm">
            <!-- 1. ì‚¬ìš©ì ID (ìë™ ë¶€ì—¬) -->
            <div class="form-group">
                <label class="form-label">ì‚¬ìš©ì ID</label>
                <div class="user-id-display" id="userIdDisplay" style="background: #ecfdf5; border: 1px solid #a7f3d0; padding: 12px 16px; border-radius: 10px; color: #065f46; font-weight: 500;">ë¡œë”© ì¤‘...</div>
                <input type="hidden" id="userId" name="userId">
                <div class="input-hint">ìë™ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤</div>
            </div>

            <!-- 2. ë‚˜ì´ -->
            <div class="form-group">
                <label for="age">ë‚˜ì´ <span style="font-size: 12px; color: #059669; font-weight: 400; margin-left: 4px;">ë§Œ ë‚˜ì´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</span></label>
                <input type="number" id="age" name="age" min="19" max="100" placeholder="ì˜ˆ: 30">
                <div class="input-hint">ì„ íƒì‚¬í•­ì…ë‹ˆë‹¤</div>
            </div>

            <!-- 3. í¬ë§ ê±°ì£¼ì§€ -->
            <div class="form-group">
                <label for="location">í¬ë§ ê±°ì£¼ì§€</label>
                <select id="location" name="location">
                    <option value="">ì„ íƒí•´ì£¼ì„¸ìš”</option>
                    <option value="ì„œìš¸íŠ¹ë³„ì‹œ">ì„œìš¸íŠ¹ë³„ì‹œ</option>
                    <option value="ë¶€ì‚°ê´‘ì—­ì‹œ">ë¶€ì‚°ê´‘ì—­ì‹œ</option>
                    <option value="ëŒ€êµ¬ê´‘ì—­ì‹œ">ëŒ€êµ¬ê´‘ì—­ì‹œ</option>
                    <option value="ì¸ì²œê´‘ì—­ì‹œ">ì¸ì²œê´‘ì—­ì‹œ</option>
                    <option value="ê´‘ì£¼ê´‘ì—­ì‹œ">ê´‘ì£¼ê´‘ì—­ì‹œ</option>
                    <option value="ëŒ€ì „ê´‘ì—­ì‹œ">ëŒ€ì „ê´‘ì—­ì‹œ</option>
                    <option value="ìš¸ì‚°ê´‘ì—­ì‹œ">ìš¸ì‚°ê´‘ì—­ì‹œ</option>
                    <option value="ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ">ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ</option>
                    <option value="ê²½ê¸°ë„">ê²½ê¸°ë„</option>
                    <option value="ê°•ì›ë„">ê°•ì›ë„</option>
                    <option value="ì¶©ì²­ë¶ë„">ì¶©ì²­ë¶ë„</option>
                    <option value="ì¶©ì²­ë‚¨ë„">ì¶©ì²­ë‚¨ë„</option>
                    <option value="ì „ë¼ë¶ë„">ì „ë¼ë¶ë„</option>
                    <option value="ì „ë¼ë‚¨ë„">ì „ë¼ë‚¨ë„</option>
                    <option value="ê²½ìƒë¶ë„">ê²½ìƒë¶ë„</option>
                    <option value="ê²½ìƒë‚¨ë„">ê²½ìƒë‚¨ë„</option>
                    <option value="ì œì£¼íŠ¹ë³„ìì¹˜ë„">ì œì£¼íŠ¹ë³„ìì¹˜ë„</option>
                </select>
                <div class="input-hint">ì„ íƒì‚¬í•­ì…ë‹ˆë‹¤</div>
            </div>

            <!-- 4. ê²°í˜¼ ì—¬ë¶€ (ìƒˆë¡œ ì¶”ê°€) -->
            <div class="form-group">
                <label>ê²°í˜¼ ì—¬ë¶€</label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" id="married" name="maritalStatus" value="Y">
                        <label for="married">ìœ </label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="single" name="maritalStatus" value="N">
                        <label for="single">ë¬´</label>
                    </div>
                </div>
                <div class="input-hint">ì„ íƒì‚¬í•­ì…ë‹ˆë‹¤</div>
            </div>

            <!-- 5. ìë…€ ìˆ˜ (ìƒˆë¡œ ì¶”ê°€) -->
            <div class="form-group">
                <label for="children">ìë…€ ìˆ˜</label>
                <select id="children" name="children">
                    <option value="">ì„ íƒí•´ì£¼ì„¸ìš”</option>
                    <option value="0">0ëª…</option>
                    <option value="1">1ëª…</option>
                    <option value="2">2ëª…</option>
                    <option value="3">3ëª…</option>
                    <option value="4">4ëª… ì´ìƒ</option>
                </select>
                <div class="input-hint">ì„ íƒì‚¬í•­ì…ë‹ˆë‹¤</div>
            </div>

            <!-- 6. ìƒì„¸ ì‹ ì²­ìê²© -->
            <div class="form-group">
                <label for="eligibility">ìƒì„¸ ì‹ ì²­ìê²©</label>
                <select id="eligibility" name="eligibility">
                    <option value="">ì„ íƒí•´ì£¼ì„¸ìš”</option>
                    <option value="ì²­ë…„">ì²­ë…„</option>
                    <option value="ì˜ˆë¹„ì‹ í˜¼ë¶€ë¶€">ì˜ˆë¹„ ì‹ í˜¼ë¶€ë¶€</option>
                    <option value="ì‹ í˜¼ë¶€ë¶€">ì‹ í˜¼ë¶€ë¶€</option>
                    <option value="ê³ ë ¹ì">ê³ ë ¹ì</option>
                    <option value="ë‹¤ìë…€ê°€êµ¬">ë‹¤ìë…€ê°€êµ¬</option>
                    <option value="ì¥ì• ì¸">ì¥ì• ì¸</option>
                    <option value="ì¼ë°˜">ì¼ë°˜</option>
                </select>
                <div class="input-hint">ì„ íƒì‚¬í•­ì…ë‹ˆë‹¤</div>
            </div>

            <!-- 7. ì†Œë“ì •ë³´ -->
            <div class="form-group">
                <label for="income">ì—°ì†Œë“ (ë§Œì›) <span style="font-size: 12px; color: #059669; font-weight: 400; margin-left: 4px;">ì—°ê°„ ì´ì†Œë“ì„ ë§Œì› ë‹¨ìœ„ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”</span></label>
                <input type="number" id="income" name="income" min="0" placeholder="ì˜ˆ: 3000">
                <div class="input-hint">ì„ íƒì‚¬í•­ì…ë‹ˆë‹¤</div>
            </div>

            <button type="submit" class="btn-submit">ğŸ’¬ ì‹œì‘í•˜ê¸°</button>
        </form>
    </div>

    <script src="{% static 'js/main.js' %}"></script>
    <script>
        // ===================================
        // ì‚¬ìš©ì í‚¤ ìƒì„± í•¨ìˆ˜ (main.jsì™€ ë™ì¼)
        // ===================================
        function getOrCreateUserKey() {
            let userKey = localStorage.getItem('user_key');
            
            if (!userKey) {
                // ëœë¤ ë‹‰ë„¤ì„ ìƒì„± (í˜•ìš©ì‚¬ + ë™ë¬¼)
                const adjectives = [
                    'ê·€ì—¬ìš´', 'ë§¤ì½¤í•œ', 'ìƒí¼í•œ', 'ë“ ë“ í•œ', 'ì‹ ë‚˜ëŠ”', 
                    'ì°¨ë¶„í•œ', 'í™œë°œí•œ', 'ë˜‘ë˜‘í•œ', 'ìš©ê°í•œ', 'ì¬ì¹˜ìˆëŠ”',
                    'ë©‹ì§„', 'ê¹œì°í•œ', 'ì”©ì”©í•œ', 'ë‹¹ë‹¹í•œ', 'ì—´ì •ì ì¸'
                ];
                
                const animals = [
                    'ê³ ì–‘ì´', 'ê°•ì•„ì§€', 'í† ë¼', 'í–„ìŠ¤í„°', 'ë‹¤ëŒì¥',
                    'ì½”ì•Œë¼', 'íŒë‹¤', 'ì—¬ìš°', 'ì‚¬ìŠ´', 'ìˆ˜ë‹¬',
                    'í­ê·„', 'ë¶€ì—‰ì´', 'ì°¸ìƒˆ', 'ì•µë¬´ìƒˆ', 'ì²­ì„¤ëª¨'
                ];
                
                const randomAdj = adjectives[Math.floor(Math.random() * adjectives.length)];
                const randomAnimal = animals[Math.floor(Math.random() * animals.length)];
                
                userKey = `${randomAdj} ${randomAnimal}`;
                
                // localStorageì— ì €ì¥
                localStorage.setItem('user_key', userKey);
                console.log('ìƒˆë¡œìš´ user_key ìƒì„±:', userKey);
            } else {
                console.log('ê¸°ì¡´ user_key ì‚¬ìš©:', userKey);
            }
            
            return userKey;
        }

        // ===================================
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‚¬ìš©ì ID ì„¤ì •
        // ===================================
        window.addEventListener('DOMContentLoaded', function() {
            const userId = getOrCreateUserKey();
            document.getElementById('userIdDisplay').textContent = userId;
            document.getElementById('userId').value = userId;
        });

        // ===================================
        // í¼ ì œì¶œ ì²˜ë¦¬
        // ===================================
        document.getElementById('userInfoForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const userId = getOrCreateUserKey(); // ë™ì¼í•œ user_key ì‚¬ìš©

            // ê²°í˜¼ ì—¬ë¶€ ê°’ ê°€ì ¸ì˜¤ê¸° (ì„ íƒí•˜ì§€ ì•Šì•˜ì„ ê²½ìš° ë¹ˆ ë¬¸ìì—´)
            const maritalStatusRadio = document.querySelector('input[name="maritalStatus"]:checked');
            const maritalStatus = maritalStatusRadio ? maritalStatusRadio.value : '';

            // í¼ ë°ì´í„° ìˆ˜ì§‘ (í•„ìˆ˜ê°’ì´ ì•„ë‹Œ ê²½ìš° null ë˜ëŠ” ë¹ˆ ë¬¸ìì—´)
            const formData = {
                userId: userId,
                age: document.getElementById('age').value ? parseInt(document.getElementById('age').value) : null,
                location: document.getElementById('location').value || '',
                maritalStatus: maritalStatus,
                children: document.getElementById('children').value ? parseInt(document.getElementById('children').value) : null,
                eligibility: document.getElementById('eligibility').value || '',
                income: document.getElementById('income').value ? parseInt(document.getElementById('income').value) : null
            };

            // sessionStorageì™€ localStorageì— ì €ì¥
            sessionStorage.setItem('userInfo', JSON.stringify(formData));
            localStorage.setItem('userInfo', JSON.stringify(formData));

            console.log('ì €ì¥ëœ ì‚¬ìš©ì ì •ë³´:', formData);

            // ë©”ì¸ í˜ì´ì§€ë¡œ ì´ë™
            window.location.href = '{% url "web:main" %}';
        });
    </script>
</body>
</html>
